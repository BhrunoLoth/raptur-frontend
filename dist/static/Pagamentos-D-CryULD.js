import{r as l,j as a}from"./index-B9Nf5u-5.js";import{a as x}from"./api-DLJ_9syT.js";import{l as N}from"./pagamentoService-BSKdu01M.js";import"./index-ngrFHoWO.js";async function b(r={}){const t=await N(r);return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.pagamentos)?t.pagamentos:[]}async function f(r,t){const{data:c}=await x.put(`/pagamentos/${r}`,t);return c}async function v(r){const{data:t}=await x.delete(`/pagamentos/${r}`);return t}const S=()=>{const[r,t]=l.useState([]),[c,d]=l.useState(""),[u,i]=l.useState(null),[h,m]=l.useState("");l.useEffect(()=>{async function e(){try{const s=await b();t(s)}catch{d("Erro ao carregar pagamentos")}}e()},[]);const g=async e=>{if(window.confirm("Deseja remover este pagamento?"))try{await v(e),t(s=>s.filter(n=>n.id!==e))}catch{d("Erro ao remover pagamento")}},p=(e,s)=>{i(e),m(s)},j=async e=>{try{const s=await f(e,{status:h});t(n=>n.map(o=>o.id===e?{...o,status:s.status}:o)),i(null),m("")}catch{d("Erro ao atualizar pagamento")}};return a.jsxs("div",{className:"dashboard-main-card px-4 py-6 max-w-full overflow-x-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"ðŸ’³ GestÃ£o de Pagamentos"}),c&&a.jsx("div",{className:"text-red-600 bg-red-100 p-3 rounded mb-4",children:c}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm text-left border border-gray-200 rounded shadow",children:[a.jsx("thead",{className:"bg-green-900 text-white",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3",children:"ID"}),a.jsx("th",{className:"p-3",children:"Viagem"}),a.jsx("th",{className:"p-3",children:"UsuÃ¡rio"}),a.jsx("th",{className:"p-3",children:"Valor"}),a.jsx("th",{className:"p-3",children:"MÃ©todo"}),a.jsx("th",{className:"p-3",children:"Status"}),a.jsx("th",{className:"p-3",children:"AÃ§Ãµes"})]})}),a.jsx("tbody",{children:r.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center p-4 text-gray-500",children:"Nenhum pagamento cadastrado"})}):r.map(e=>{var s,n;return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"p-3",children:e.id}),a.jsx("td",{className:"p-3",children:e.viagemId||((s=e.viagem)==null?void 0:s.id)||"â€”"}),a.jsx("td",{className:"p-3",children:((n=e.usuario)==null?void 0:n.nome)||e.usuarioId}),a.jsxs("td",{className:"p-3",children:["R$ ",Number(e.valor).toFixed(2)]}),a.jsx("td",{className:"p-3",children:e.metodo}),a.jsx("td",{className:"p-3",children:u===e.id?a.jsxs("select",{value:h,onChange:o=>m(o.target.value),className:"border rounded px-2 py-1",children:[a.jsx("option",{value:"pendente",children:"Pendente"}),a.jsx("option",{value:"pago",children:"Pago"}),a.jsx("option",{value:"falhou",children:"Falhou"})]}):a.jsx("span",{className:"font-medium capitalize",children:e.status})}),a.jsx("td",{className:"p-3 flex gap-2 flex-wrap",children:u===e.id?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>j(e.id),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Salvar"}),a.jsx("button",{onClick:()=>i(null),className:"px-3 py-1 bg-gray-400 text-white rounded hover:bg-gray-500",children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>p(e.id,e.status),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Editar"}),a.jsx("button",{onClick:()=>g(e.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"Remover"})]})})]},e.id)})})]})})]})};export{S as default};
