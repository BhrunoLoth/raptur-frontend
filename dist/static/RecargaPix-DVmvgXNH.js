import{k as M,j as e,g as ga,c as fa,r as d,d as xa,I as ma,i as aa,e as B,v as ea,s as ca,f as l,h as ba,m as Ca,K as $,O as N,B as V,T as S,A as _,b as A,C as oa,P as ya}from"./index-B9Nf5u-5.js";import{f as q,a as $a,p as ha,m as ja}from"./pagamentoService-BSKdu01M.js";import{g as Ia}from"./api-DLJ_9syT.js";import{C as ra,a as ta}from"./CardContent-Be5sf3AR.js";import{G as la}from"./Grid-CnWnp_Lf.js";import{T as na}from"./TextField-t-1AHP0N.js";import{D as Sa}from"./Divider-DhoczBON.js";import"./index-ngrFHoWO.js";import"./useThemeProps-g9lUOIHl.js";import"./dividerClasses-0nFLKQrh.js";const ka=M(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function Pa(a){return fa("MuiChip",a)}const r=ga("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),za=a=>{const{classes:t,disabled:o,size:c,color:u,iconColor:C,onDelete:g,clickable:s,variant:v}=a,h={root:["root",v,o&&"disabled",`size${l(c)}`,`color${l(u)}`,s&&"clickable",s&&`clickableColor${l(u)}`,g&&"deletable",g&&`deletableColor${l(u)}`,`${v}${l(u)}`],label:["label",`label${l(c)}`],avatar:["avatar",`avatar${l(c)}`,`avatarColor${l(u)}`],icon:["icon",`icon${l(c)}`,`iconColor${l(C)}`],deleteIcon:["deleteIcon",`deleteIcon${l(c)}`,`deleteIconColor${l(u)}`,`deleteIcon${l(v)}Color${l(u)}`]};return ba(h,Pa,t)},Ra=ca("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:o}=a,{color:c,iconColor:u,clickable:C,onDelete:g,size:s,variant:v}=o;return[{[`& .${r.avatar}`]:t.avatar},{[`& .${r.avatar}`]:t[`avatar${l(s)}`]},{[`& .${r.avatar}`]:t[`avatarColor${l(c)}`]},{[`& .${r.icon}`]:t.icon},{[`& .${r.icon}`]:t[`icon${l(s)}`]},{[`& .${r.icon}`]:t[`iconColor${l(u)}`]},{[`& .${r.deleteIcon}`]:t.deleteIcon},{[`& .${r.deleteIcon}`]:t[`deleteIcon${l(s)}`]},{[`& .${r.deleteIcon}`]:t[`deleteIconColor${l(c)}`]},{[`& .${r.deleteIcon}`]:t[`deleteIcon${l(v)}Color${l(c)}`]},t.root,t[`size${l(s)}`],t[`color${l(c)}`],C&&t.clickable,C&&c!=="default"&&t[`clickableColor${l(c)})`],g&&t.deletable,g&&c!=="default"&&t[`deletableColor${l(c)}`],t[v],t[`${v}${l(c)}`]]}})(Ca(({theme:a})=>{const t=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return{maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${r.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${r.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:t,fontSize:a.typography.pxToRem(12)},[`& .${r.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${r.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${r.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${r.icon}`]:{marginLeft:5,marginRight:-6},[`& .${r.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:$(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:$(a.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${r.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${r.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(a.palette).filter(N(["contrastText"])).map(([o])=>({props:{color:o},style:{backgroundColor:(a.vars||a).palette[o].main,color:(a.vars||a).palette[o].contrastText,[`& .${r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[o].contrastTextChannel} / 0.7)`:$(a.palette[o].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[o].contrastText}}}})),{props:o=>o.iconColor===o.color,style:{[`& .${r.icon}`]:{color:a.vars?a.vars.palette.Chip.defaultIconColor:t}}},{props:o=>o.iconColor===o.color&&o.color!=="default",style:{[`& .${r.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:$(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}}},...Object.entries(a.palette).filter(N(["dark"])).map(([o])=>({props:{color:o,onDelete:!0},style:{[`&.${r.focusVisible}`]:{background:(a.vars||a).palette[o].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:$(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:$(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}}},...Object.entries(a.palette).filter(N(["dark"])).map(([o])=>({props:{color:o,clickable:!0},style:{[`&:hover, &.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${r.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${r.avatar}`]:{marginLeft:4},[`& .${r.avatarSmall}`]:{marginLeft:2},[`& .${r.icon}`]:{marginLeft:4},[`& .${r.iconSmall}`]:{marginLeft:2},[`& .${r.deleteIcon}`]:{marginRight:5},[`& .${r.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(a.palette).filter(N()).map(([o])=>({props:{variant:"outlined",color:o},style:{color:(a.vars||a).palette[o].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[o].mainChannel} / 0.7)`:$(a.palette[o].main,.7)}`,[`&.${r.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:$(a.palette[o].main,a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o].mainChannel} / ${a.vars.palette.action.focusOpacity})`:$(a.palette[o].main,a.palette.action.focusOpacity)},[`& .${r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[o].mainChannel} / 0.7)`:$(a.palette[o].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[o].main}}}}))]}})),Va=ca("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,t)=>{const{ownerState:o}=a,{size:c}=o;return[t.label,t[`label${l(c)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function ia(a){return a.key==="Backspace"||a.key==="Delete"}const G=d.forwardRef(function(t,o){const c=xa({props:t,name:"MuiChip"}),{avatar:u,className:C,clickable:g,color:s="default",component:v,deleteIcon:h,disabled:D=!1,icon:x,label:f,onClick:w,onDelete:m,onKeyDown:O,onKeyUp:T,size:L="medium",variant:R="filled",tabIndex:b,skipFocusWhenDisabled:j=!1,slots:H={},slotProps:W={},...X}=c,K=d.useRef(null),U=ma(K,o),F=i=>{i.stopPropagation(),m&&m(i)},n=i=>{i.currentTarget===i.target&&ia(i)&&i.preventDefault(),O&&O(i)},p=i=>{i.currentTarget===i.target&&m&&ia(i)&&m(i),T&&T(i)},k=g!==!1&&w?!0:g,y=k||m?aa:v||"div",E={...c,component:y,disabled:D,size:L,color:s,iconColor:d.isValidElement(x)&&x.props.color||s,onDelete:!!m,clickable:k,variant:R},I=za(E),sa=y===aa?{component:v||"div",focusVisibleClassName:I.focusVisible,...m&&{disableRipple:!0}}:{};let Q=null;m&&(Q=h&&d.isValidElement(h)?d.cloneElement(h,{className:B(h.props.className,I.deleteIcon),onClick:F}):e.jsx(ka,{className:I.deleteIcon,onClick:F}));let J=null;u&&d.isValidElement(u)&&(J=d.cloneElement(u,{className:B(I.avatar,u.props.className)}));let Y=null;x&&d.isValidElement(x)&&(Y=d.cloneElement(x,{className:B(I.icon,x.props.className)}));const Z={slots:H,slotProps:W},[da,pa]=ea("root",{elementType:Ra,externalForwardedProps:{...Z,...X},ownerState:E,shouldForwardComponentProp:!0,ref:U,className:B(I.root,C),additionalProps:{disabled:k&&D?!0:void 0,tabIndex:j&&D?-1:b,...sa},getSlotProps:i=>({...i,onClick:P=>{var z;(z=i.onClick)==null||z.call(i,P),w(P)},onKeyDown:P=>{var z;(z=i.onKeyDown)==null||z.call(i,P),n(P)},onKeyUp:P=>{var z;(z=i.onKeyUp)==null||z.call(i,P),p(P)}})}),[ua,va]=ea("label",{elementType:Va,externalForwardedProps:Z,ownerState:E,className:I.label});return e.jsxs(da,{as:y,...pa,children:[J||Y,e.jsx(ua,{...va,children:f}),Q]})}),wa=M(e.jsx("path",{d:"M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2zm-9-2h10V8H12zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),Oa=M(e.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Ta=M(e.jsx("path",{d:"M15 21h-2v-2h2zm-2-7h-2v5h2zm8-2h-2v4h2zm-2-2h-2v2h2zM7 12H5v2h2zm-2-2H3v2h2zm7-5h2V3h-2zm-7.5-.5v3h3v-3zM9 9H3V3h6zm-4.5 7.5v3h3v-3zM9 21H3v-6h6zm7.5-16.5v3h3v-3zM21 9h-6V3h6zm-2 10v-3h-4v2h2v3h4v-2zm-2-7h-4v2h4zm-4-2H7v2h2v2h2v-2h2zm1-1V7h-2V5h-2v4zM6.75 5.25h-1.5v1.5h1.5zm0 12h-1.5v1.5h1.5zm12-12h-1.5v1.5h1.5z"})),Da=M(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}));function Ua(){const[a,t]=d.useState(""),[o,c]=d.useState(null),[u,C]=d.useState(""),[g,s]=d.useState(""),[v,h]=d.useState(!1),[D,x]=d.useState(!1),[f,w]=d.useState(null),[m,O]=d.useState(null),[T,L]=d.useState(null),R=d.useRef(null),b=d.useRef(null),j=Ia(),H=[10,20,50,100];d.useEffect(()=>()=>{R.current&&R.current(),b.current&&clearInterval(b.current)},[]),d.useEffect(()=>{if(f!=null&&f.expiration_date){const n=()=>{const p=new Date,y=new Date(f.expiration_date)-p;if(y<=0){L("Expirado"),b.current&&clearInterval(b.current);return}const E=Math.floor(y/6e4),I=Math.floor(y%6e4/1e3);L(`${E}:${I.toString().padStart(2,"0")}`)};return n(),b.current=setInterval(n,1e3),()=>{b.current&&clearInterval(b.current)}}},[f==null?void 0:f.expiration_date]);const W=async()=>{s(""),c(null),C(""),w(null),O(null);const n=parseFloat(a.replace(",","."));if(!n||n<=0){s("Digite um valor de recarga válido (maior que zero).");return}if(n>1e3){s("Valor máximo para recarga é R$ 1.000,00.");return}h(!0);try{const p=await ha(n,`Recarga de créditos - ${(j==null?void 0:j.nome)||"Usuário"}`);p.sucesso&&(w(p.pagamento),c(p.qr_code_base64),C(p.qr_code),s("PIX gerado com sucesso! Escaneie o QR Code ou copie o código."),X(p.pagamento.id))}catch(p){console.error("❌ Erro na recarga:",p),s(`Erro ao gerar PIX: ${p.message}`)}finally{h(!1)}},X=n=>{x(!0),R.current=ja(n,p=>{var y;if(p.erro){console.error("Erro no monitoramento:",p.erro);return}O(p);const k=(y=p.pagamento_local)==null?void 0:y.status;k==="pago"?(s("✅ Pagamento aprovado! Seu saldo foi creditado."),x(!1),setTimeout(()=>{window.location.reload()},2e3)):["falhou","cancelado","expirado"].includes(k)&&(s(`❌ Pagamento ${k}. Tente novamente.`),x(!1))},3e3)},K=async()=>{if(u)try{await navigator.clipboard.writeText(u),s("✅ Código PIX copiado para a área de transferência!")}catch(n){console.error("Erro ao copiar:",n),s("❌ Erro ao copiar código. Tente selecionar e copiar manualmente.")}},U=n=>{t(n.toString())},F=()=>{t(""),c(null),C(""),w(null),O(null),s(""),x(!1),R.current&&R.current(),b.current&&clearInterval(b.current)};return e.jsxs(V,{sx:{maxWidth:600,mx:"auto",p:3},children:[e.jsxs(S,{variant:"h4",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(wa,{}),"Recarga via PIX"]}),(j==null?void 0:j.saldo_credito)!==void 0&&e.jsxs(_,{severity:"info",sx:{mb:3},children:[e.jsx("strong",{children:"Saldo atual:"})," ",q(parseFloat(j.saldo_credito)||0)]}),e.jsx(ra,{children:e.jsxs(ta,{children:[!f&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"h6",gutterBottom:!0,children:"Valor da Recarga"}),e.jsxs(V,{sx:{mb:2},children:[e.jsx(S,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Valores sugeridos:"}),e.jsx(la,{container:!0,spacing:1,children:H.map(n=>e.jsx(la,{item:!0,children:e.jsx(G,{label:q(n),onClick:()=>U(n),variant:a===n.toString()?"filled":"outlined",color:"primary",clickable:!0})},n))})]}),e.jsx(na,{fullWidth:!0,label:"Valor (R$)",value:a,onChange:n=>t(n.target.value),type:"number",inputProps:{min:.01,max:1e3,step:.01},sx:{mb:2},helperText:"Valor mínimo: R$ 0,01 | Valor máximo: R$ 1.000,00"}),e.jsx(A,{fullWidth:!0,variant:"contained",onClick:W,disabled:v||!a,startIcon:v?e.jsx(oa,{size:20}):e.jsx(Ta,{}),size:"large",children:v?"Gerando PIX...":"Gerar PIX"})]}),f&&e.jsxs(e.Fragment,{children:[e.jsxs(V,{sx:{textAlign:"center",mb:3},children:[e.jsxs(S,{variant:"h6",gutterBottom:!0,children:["PIX Gerado - ",q(f.valor)]}),T&&e.jsx(G,{label:`Expira em: ${T}`,color:T==="Expirado"?"error":"warning",sx:{mb:2}})]}),o&&e.jsxs(V,{sx:{textAlign:"center",mb:3},children:[e.jsx(ya,{elevation:2,sx:{p:2,display:"inline-block"},children:e.jsx("img",{src:`data:image/png;base64,${o}`,alt:"QR Code PIX",style:{maxWidth:"200px",width:"100%"}})}),e.jsx(S,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Escaneie com o app do seu banco"})]}),u&&e.jsxs(V,{sx:{mb:3},children:[e.jsx(S,{variant:"body2",gutterBottom:!0,children:"Ou copie o código PIX:"}),e.jsx(na,{fullWidth:!0,multiline:!0,rows:3,value:u,InputProps:{readOnly:!0,endAdornment:e.jsx(A,{onClick:K,startIcon:e.jsx(Oa,{}),size:"small",children:"Copiar"})},sx:{mb:1}})]}),D&&e.jsx(_,{severity:"info",sx:{mb:2},children:e.jsxs(V,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(oa,{size:16}),"Aguardando pagamento..."]})}),m&&e.jsxs(V,{sx:{mb:2},children:[e.jsx(S,{variant:"body2",gutterBottom:!0,children:"Status do pagamento:"}),(()=>{var p;const n=$a((p=m.pagamento_local)==null?void 0:p.status);return e.jsx(G,{label:`${n.icone} ${n.texto}`,color:n.cor,variant:"filled"})})()]}),e.jsx(Sa,{sx:{my:2}}),e.jsx(A,{fullWidth:!0,variant:"outlined",onClick:F,startIcon:e.jsx(Da,{}),children:"Nova Recarga"})]}),g&&e.jsx(_,{severity:g.includes("✅")?"success":g.includes("❌")?"error":"info",sx:{mt:2},children:g})]})}),e.jsx(ra,{sx:{mt:3},children:e.jsxs(ta,{children:[e.jsx(S,{variant:"h6",gutterBottom:!0,children:"Como funciona?"}),e.jsx(S,{variant:"body2",component:"div",children:e.jsxs("ol",{children:[e.jsx("li",{children:"Digite o valor que deseja recarregar"}),e.jsx("li",{children:'Clique em "Gerar PIX" para criar o código de pagamento'}),e.jsx("li",{children:"Escaneie o QR Code com o app do seu banco ou copie o código PIX"}),e.jsx("li",{children:"Realize o pagamento no seu banco"}),e.jsx("li",{children:"O saldo será creditado automaticamente após a confirmação"})]})})]})})]})}export{Ua as default};
