import{r as d,j as e}from"./index-B9Nf5u-5.js";import{a as l}from"./api-DLJ_9syT.js";import"./index-ngrFHoWO.js";async function N(t={}){const s=new URLSearchParams;return Object.entries(t).forEach(([o,n])=>{n&&s.append(o,n)}),(await l.get(`/embarques?${s.toString()}`)).data}async function f(){return N()}async function q(t){return(await l.post("/embarques",t)).data}async function E(t,s){return(await l.put(`/embarques/${t}`,s)).data}async function w(t){await l.delete(`/embarques/${t}`)}const D=()=>{const[t,s]=d.useState([]),[c,o]=d.useState(""),[n,h]=d.useState({viagemId:"",usuarioId:"",status:"pendente",dataHora:""}),[x,u]=d.useState(null),[b,m]=d.useState("");d.useEffect(()=>{(async()=>{try{const r=await f();s(Array.isArray(r)?r:[])}catch{o("Erro ao carregar embarques"),s([])}})()},[]);const i=a=>{h({...n,[a.target.name]:a.target.value})},g=async a=>{a.preventDefault();try{const r=await q(n);s([...t,r]),h({viagemId:"",usuarioId:"",status:"pendente",dataHora:""}),o("")}catch{o("Erro ao criar embarque")}},j=async a=>{if(window.confirm("Deseja remover este embarque?"))try{await w(a),s(t.filter(r=>r.id!==a))}catch{o("Erro ao remover embarque")}},y=(a,r)=>{u(a),m(r)},v=async a=>{try{const r=await E(a,{status:b});s(t.map(p=>p.id===a?{...p,status:r.status}:p)),u(null),m(""),o("")}catch{o("Erro ao atualizar embarque")}};return e.jsxs("div",{className:"dashboard-main-card px-4 py-6 max-w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"ðŸ“¦ GestÃ£o de Embarques"}),c&&e.jsx("div",{className:"text-red-600 bg-red-100 p-3 rounded mb-4",children:c}),e.jsxs("form",{onSubmit:g,className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("input",{name:"viagemId",placeholder:"Viagem ID",value:n.viagemId,onChange:i,className:"border px-3 py-2 rounded",required:!0}),e.jsx("input",{name:"usuarioId",placeholder:"UsuÃ¡rio ID",value:n.usuarioId,onChange:i,className:"border px-3 py-2 rounded",required:!0}),e.jsxs("select",{name:"status",value:n.status,onChange:i,className:"border px-3 py-2 rounded",required:!0,children:[e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"confirmado",children:"Confirmado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]}),e.jsx("input",{name:"dataHora",type:"datetime-local",value:n.dataHora,onChange:i,className:"border px-3 py-2 rounded",required:!0}),e.jsx("button",{type:"submit",className:"col-span-full sm:col-span-2 lg:col-span-1 bg-green-700 hover:bg-green-800 text-white py-2 rounded",children:"âž• Criar"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left border border-gray-200 rounded shadow",children:[e.jsx("thead",{className:"bg-green-900 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"ID"}),e.jsx("th",{className:"p-3",children:"Viagem"}),e.jsx("th",{className:"p-3",children:"UsuÃ¡rio"}),e.jsx("th",{className:"p-3",children:"Status"}),e.jsx("th",{className:"p-3",children:"Data/Hora"}),e.jsx("th",{className:"p-3",children:"AÃ§Ãµes"})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center p-4 text-gray-500",children:"Nenhum embarque cadastrado"})}):t.map(a=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:a.id}),e.jsx("td",{className:"p-3",children:a.viagemId}),e.jsx("td",{className:"p-3",children:a.usuarioId}),e.jsx("td",{className:"p-3",children:x===a.id?e.jsxs("select",{value:b,onChange:r=>m(r.target.value),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"confirmado",children:"Confirmado"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]}):e.jsx("span",{className:"font-medium",children:a.status})}),e.jsx("td",{className:"p-3",children:a.dataHora?new Date(a.dataHora).toLocaleString():"--"}),e.jsx("td",{className:"p-3 flex gap-2 flex-wrap",children:x===a.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>v(a.id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded",children:"Salvar"}),e.jsx("button",{type:"button",onClick:()=>u(null),className:"bg-gray-400 hover:bg-gray-500 text-white px-3 py-1 rounded",children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>y(a.id,a.status),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded",children:"Editar"}),e.jsx("button",{type:"button",onClick:()=>j(a.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded",children:"Remover"})]})})]},a.id))})]})})]})};export{D as default};
