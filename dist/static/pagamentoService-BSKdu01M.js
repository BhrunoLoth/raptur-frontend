import{a as s}from"./api-DLJ_9syT.js";function u(r){return r?Array.isArray(r)?r:Array.isArray(r==null?void 0:r.pagamentos)?r.pagamentos:Array.isArray(r==null?void 0:r.items)?r.items:Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r==null?void 0:r.rows)?r.rows:[]:[]}function x(r){return{pendente:{texto:"Pendente",cor:"warning",icone:"‚è≥"},pago:{texto:"Pago",cor:"success",icone:"‚úÖ"},falhou:{texto:"Falhou",cor:"error",icone:"‚ùå"},cancelado:{texto:"Cancelado",cor:"default",icone:"üö´"},expirado:{texto:"Expirado",cor:"default",icone:"‚è∞"}}[r]||{texto:r||"‚Äî",cor:"default",icone:"‚ùì"}}function w(r){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(r||0))}async function P(r={}){const o=new URLSearchParams;Object.entries(r).forEach(([c,n])=>{n!=null&&n!==""&&o.append(c,n)});const{data:e}=await s.get(`/pagamentos?${o.toString()}`),t=u(e),a=Number((e==null?void 0:e.total)??(e==null?void 0:e.count)??t.length??0);return{lista:t,total:a,raw:e}}async function m(r){const{data:o}=await s.post("/pagamentos/pix/criar",r);return o}async function f(r){const{data:o}=await s.get(`/pagamentos/${r}/status`);return o}async function A(r,o="Recarga de cr√©ditos"){const e=Number(r);if(!e||e<=0)throw new Error("Valor deve ser maior que zero");try{const t=await m({valor:e,descricao:o}),a=(t==null?void 0:t.pagamento)||{};return{sucesso:!0,pagamento:t==null?void 0:t.pagamento,qr_code:a.qr_code,qr_code_base64:a.qr_code_base64,expiration_date:a.expiration_date}}catch(t){throw console.error("‚ùå Erro ao processar recarga PIX:",t),new Error((t==null?void 0:t.message)||"Erro ao processar recarga PIX")}}function h(r,o,e=3e3){let t=!0;const a=async()=>{var c;if(t)try{const n=await f(r);o(n);const i=(c=n==null?void 0:n.pagamento_local)==null?void 0:c.status;if(["pago","falhou","cancelado","expirado"].includes(i)){t=!1;return}t&&setTimeout(a,e)}catch(n){console.error("‚ùå Erro ao monitorar pagamento:",n),o({erro:(n==null?void 0:n.message)||String(n)}),t&&setTimeout(a,e*2)}};return a(),()=>{t=!1}}export{x as a,w as f,P as l,h as m,A as p};
